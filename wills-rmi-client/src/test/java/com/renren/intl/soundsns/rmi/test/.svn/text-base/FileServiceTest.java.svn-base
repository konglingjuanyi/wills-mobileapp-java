package com.renren.intl.soundsns.rmi.test;

import static org.junit.Assert.assertFalse;

import java.io.InputStream;


import org.junit.Ignore;
import org.junit.Test;

import com.renren.intl.soundsns.constant.PhotoStyle;
import com.renren.intl.soundsns.rmi.client.FileServerDelegate;
import com.renren.intl.soundsns.rmi.client.ResourceServiceDelegate;
import com.renren.intl.soundsns.service.IFileService;

public class FileServiceTest {
	//private static FileManagerServiceDelegate manager = new FileManagerServiceDelegate();
	private static ResourceServiceDelegate resource = new ResourceServiceDelegate();
	private static FileServerDelegate fileServer = new FileServerDelegate();
	
	@Ignore @Test
	public void uploadPhotoTest(){
		System.out.println("upload photo test begin");
		InputStream stream = FileServiceTest.class.getResourceAsStream("/test_photo.jpg");
		assertFalse("test resource is not exists, please check out whether test_photo.jpg in class path", stream == null);
		
		long photoId = fileServer.uploadResource("test_photo.jpg", IFileService.FEED_PHOTO_RESOURCE, stream);
		GlobalValue.pictureId= photoId;
		assertFalse("upload feed photo to store error, please check store service is correct?", photoId < 0);
		System.out.println("upload feed photo id is : " + photoId);
		
		String photoUrl = resource.getPhotoURL(photoId, PhotoStyle.LARGE);
		assertFalse("feed photo upload success , but get photo url error, maybe photo compress service error, please check out photo compress service is running correctly", photoUrl == null);
		System.out.println("feed upload photo url is : "+ photoUrl);
		
		stream = FileServiceTest.class.getResourceAsStream("/test_photo.jpg");
		assertFalse("test resource is not exists, please check out whether test_photo.jpg in class path", stream == null);
		photoId = fileServer.uploadResource("test_photo.jpg", IFileService.HEAD_PHOTO_RESOURCE, stream);
		
		assertFalse("upload head photo to store error, please check store service is correct?",photoId < 0);
		System.out.println("upload head photo id is : " + photoId);
		
		photoUrl = resource.getPhotoURL(photoId, PhotoStyle.LARGE);
		assertFalse("head photo upload success , but get photo url error, maybe photo compress service error, please check out photo compress service is running correctly", photoUrl == null);
		System.out.println("head upload photo url is : "+ photoUrl);

		System.out.println("upload photo test end");
	}
	
	@Ignore @Test
	public void uploadSoundTest(){
		System.out.println("upload sound test begin!");
		InputStream stream =  FileServiceTest.class.getResourceAsStream("/test_sound.mp3");
		assertFalse("test resource is not exists, please check out whether test_photo.jpg in class path",stream == null);
		long soundId = fileServer.uploadResource("test_sound.mp3", IFileService.SOUND_RESOURCE, stream);
		GlobalValue.soundId = soundId;
		assertFalse("upload sound to store error, please check store service is correct?",soundId < 0);
		System.out.println("sound upload sound id is "+soundId);
		
		String soundUrl = resource.getRecordURL(soundId);
		assertFalse("upload sound success, but get sound url error, please check out resource service",soundUrl == null);
		System.out.println("sound url is : "+ soundUrl);	
		System.out.println("upload sound test end!");
	}
	

}
